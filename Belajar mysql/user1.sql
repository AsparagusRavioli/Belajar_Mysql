START TRANSACTION ;

SELECT * FROM guestbooks;

UPDATE guestbooks
SET title = 'Diubah oleh user 1'
WHERE id = 10;

COMMIT;

START TRANSACTION;

SELECT * FROM produk;

SELECT * FROM produk WHERE id = 'P001' FOR UPDATE;

UPDATE produk
SET quantity = quantity - 10
WHERE id = 'P001';

COMMIT;

SELECT * FROM produk WHERE id = 'P001' ;

# DEADLOCK

START TRANSACTION;

SELECT * FROM produk WHERE id = 'P001' FOR UPDATE;

SELECT * FROM produk WHERE id = 'P002' FOR UPDATE;


# LOCK TABLE 

LOCK TABLE produk READ;

SELECT * FROM produk;

UPDATE produk 
SET quantity = 80
WHERE id = 'P001';

UNLOCK TABLES;

# LOCK TABLE WRITE 

LOCK TABLE produk WRITE;

UPDATE produk 
SET quantity = 110
WHERE id = 'P001';

SELECT * FROM produk;

UNLOCK TABLE;

# LOCK INSTANCE 

LOCK INSTANCE FOR BACKUP;

UNLOCK INSTANCE;

